<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
	<style>
		.toc {
			margin-left: 30px;
		}
		.code {
			margin-left: 30px;
			color:#000000;
			background-color:#ffffff;
		}
		.shell {
			margin-left: 30px;
			color:#000000;
			background-color:#ffffff;
		}
	</style> 
</head>
<body bgcolor="#EAE28A"><br><br>
<table align="center" cellpadding="50" border="1" bgcolor="#FAF29A" width="720"><tbody><tr><td>

<h1>Honors Projects - Android version</h1>

<p>Students taking the honors section of this class are required to get this project working.  If you are not in the honors section, you are more than welcome to have fun with it!</p>

<ol>
	<li>If you have an Android mobile device, <b>enable "Developer options".</b>
		Use a search engine to learn how. It's usually something like this:
		Go to settings->About phone, and tap seven times on the build number.
		Then, enable debugging, and plug your phone into a USB port on your computer.
		</li><br><br>

	<li>On your desktop or laptop computer, <b>download and install Android Developer Studio.</b>
		(Android Developer Studio is an IDE.)
		Please note that Android Developer Studio is still under heavy development,
		so these instructions will probably be outdated very quickly.
		As that happens, if you update these instructions and send them to me, others will probably be grateful.
		</li><br><br>

	<li><b>Start a new project.</b>
		When it asked me what to select a Project Template, I chose "Phone and Tablet".
		When it asked me to pick an activity, I chose "Empty Activity" because it looked like the simplest one.  I chose 'Java' as the language, and the minimum API at the lowest one (4.1 Jelly Bean) so that it would run on 99.8% of devices.  It took a while to load on my computer.
		</li><br><br>

	<li><b>Test it.</b>
		You should be able to press the run button, <img src="android_run.png">, and it should run the program on your phone.
		(Of course, it doesn't do anything interesting yet.)
		If you want, it will give you the option to download an emulator for your phone so you don't have to have your phone plugged in to run tests.
		</li><br><br>

	<li><b>Install the Android SDK for your phone's operating system.</b>
		In Android Studio, click on this button, <img src="android_download.png">.
		Put a check by the operating system of your phone and click OK.
		</li><br><br>

	<li>We will start with a simple Android game.
		<b>Add these two images to the project</b>:<br>
		Right-click on "res", click "new->Image Asset".
		(The first pull-down menu will say "Launcher Icons". I don't know what that's about, but I just left that alone and it worked for me.)
		Give your image a name, like "bird1".
		Change the Asset type to "Image".
		After Path, click on the folder button and browse for your image.<br>
		<img src="bird1.png">
		<img src="bird2.png"><br>
		Choose whichever other settings you would like for the foreground and background layers.
		Then, click "Next" and "Finish".
		</li><br><br>

	<li><b>Edit the code</b>.
		Find and edit the java code for your app (under App->java).
		Replace it with the code below.
		(The parts in red depend on the name you picked for your project, so you probably want to leave those parts the way they were generated by the wizard.
		The parts in green depend on the name you picked for your images.)
<pre class="code">
package <font color="red">com.paradigms.bird;</font>

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class <font color="red">Bird</font> extends AppCompatActivity
{
    Model model;
    GameView view;
    GameController controller;

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        model = new Model();
        view = new GameView(this, model);
        controller = new GameController(model, view);
        setContentView(view);
    }

    @Override
    protected void onPostCreate(Bundle savedInstanceState)
    {
        super.onPostCreate(savedInstanceState);
    }

    @Override
    protected void onResume()
    {
        super.onResume();
        controller.resume();
    }

    @Override
    protected void onPause()
    {
        super.onPause();
        controller.pause();
    }



    static class Model
    {
        boolean flap = false;
        boolean flapped_recently = false;
        float x = 200.0f;
        float y = 200.0f;
        float yVelocity = -8.0f;

        void update()
        {
            if(flap)
            {
                yVelocity = -24.0f;
                flap = false;
            }

            // Fall
            yVelocity += 1.8f;
            y += yVelocity;

            // Bounce on the bottom of the screen
            if(y &gt; 700.0f)
            {
                y = 700.0f;
                yVelocity = -6.0f;
            }
        }
    }




    static class GameView extends SurfaceView
    {
        SurfaceHolder ourHolder;
        Canvas canvas;
        Paint paint;
        Model model;
        GameController controller;
        Bitmap bird1;
        Bitmap bird2;

        public GameView(Context context, Model m)
        {
            super(context);
            model = m;

            // Initialize ourHolder and paint objects
            ourHolder = getHolder();
            paint = new Paint();

            // Load the images
            bird1 = BitmapFactory.decodeResource(this.getResources(),
                    <font color="green">R.mipmap.bird1</font>);
            bird2 = BitmapFactory.decodeResource(this.getResources(),
                    <font color="green">R.mipmap.bird2</font>);
        }

        void setController(GameController c)
        {
            controller = c;
        }

        public void update()
        {
            if (!ourHolder.getSurface().isValid())
                return;
            canvas = ourHolder.lockCanvas();

            // Draw the background color
            canvas.drawColor(Color.argb(255, 128, 200, 200));

            // Draw the score
            /*paint.setColor(Color.argb(255,  200, 128, 0));
            paint.setTextSize(45);
            canvas.drawText("Score:" + score, 25, 35, paint);*/

            // Draw the bird
            if(model.flapped_recently)
                canvas.drawBitmap(bird2, model.x, model.y, paint);
            else
                canvas.drawBitmap(bird1, model.x, model.y, paint);

            ourHolder.unlockCanvasAndPost(canvas);
        }

        // The SurfaceView class (which GameView extends) already
        // implements onTouchListener, so we override this method
        // and pass the event to the controller.
        @Override
        public boolean onTouchEvent(MotionEvent motionEvent)
        {
            controller.onTouchEvent(motionEvent);
            return true;
        }
    }




    static class GameController implements Runnable
    {
        volatile boolean playing;
        Thread gameThread = null;
        Model model;
        GameView view;

        GameController(Model m, GameView v)
        {
            model = m;
            view = v;
            view.setController(this);
            playing = true;
        }

        void update()
        {
        }

        @Override
        public void run()
        {
            while(playing)
            {
                //long time = System.currentTimeMillis();
                this.update();
                model.update();
                view.update();

                try {
                    Thread.sleep(20);
                } catch(Exception e) {
                    Log.e("Error:", "sleeping");
                    System.exit(1);
                }
            }
        }

        void onTouchEvent(MotionEvent motionEvent)
        {
            switch (motionEvent.getAction() &amp; MotionEvent.ACTION_MASK) {
                case MotionEvent.ACTION_DOWN: // Player touched the screen
                    model.flap = true;
                    model.flapped_recently = true;
                    break;

                case MotionEvent.ACTION_UP: // Player withdrew finger
                    model.flapped_recently = false;
                    break;
            }
        }

        // Shut down the game thread.
        public void pause() {
            playing = false;
            try {
                gameThread.join();
            } catch (InterruptedException e) {
                Log.e("Error:", "joining thread");
                System.exit(1);
            }

        }

        // Restart the game thread.
        public void resume() {
            playing = true;
            gameThread = new Thread(this);
            gameThread.start();
        }
    }
}
</pre>
		</li><br><br>

	<li><b>Note the differences with your Desktop game:</b>
		<ul>
			<li>Instead of extending JFrame, the main class extends AppCompatActivity.
				And, instead of extending JPanel, the view extends SurfaceView.
				Since Android is a different platform, it has its own class library that differs from the usual Java class library.</li>
			<li>Instead of using 3 separate files, the model, view, and controller classes are all put inside of the main class.
				Yes, you can do that in Java.
				It would probably be cleaner to put them in separate files, but you can do it like this as well.
				When you declare a class inside of another class, you typically want to declare the inner class "static",
				or else Java implicitly adds some overhead bloat to all of the objects of that class.</li>
			<li>The main loop runs in its own thread so that the game can be easily paused and resumed by killing or restarting that thread.
				This thread is implemented in GameController.run.</li>
			<li>Instead of loading the images from a file, they are encoded as a "resource",
				which basically means it is embedded somewhere inside the jar file.
				(A jar file is a renamed zip archive that contains the Java class files as well as other files your program might need.)</li>
		</ul>
		</li><br><br>

	<li><b>Turn this into a Mario game</b>.
		You can just use most of the code from your other projects, but you may need to bring it over in pieces so you can keep it working.
		Your game does not need to be exactly the same as previous versions.
		It should have a Mario that can run and jump. It should also have tubes that scroll by, and goombas that bounce.
		You do not need to support map editing or variable jumping heights.
		For controls, you might consider dividing the screen into 4 quadrants:<br>
		Touch bottom-left = left arrow<br>
		Touch bottom-right = right arrow<br>
		Touch top-left = jump<br>
		Touch top-right = throw fireball<br>
		</li><br><br>

	<li><b>Turn it in</b>.
		Zip up and submit your code in the usual manner.
		</li><br><br>

<br><br><br><br><h2>General Rubric (subject to change as needed):</h2>
For honors students only, you should submit all necessary files through Blackboard in a zip file named "<b>Honors.zip</b>".  Your code should, in general:
<ul>
	<li>Compile in Android Studio without any errors.</li>
	<li>Show a Mario character, at least two tubes, and a goomba (without requiring the grader to do anything other than start your program).</li>
	<li>Provide some clear way to move Mario.</li>
	<li>Mario should animate, and the tubes should scroll when he does.</li>
</ul>
If you meet these requirements, you should expect full credit (minus any late penalty).




<br><br><br><br><br><br><h2>Q & A</h2>

<ul>
	<li><b>Q: How do I scale my bitmaps to the desired resolution?</b><br>
		A: 
<pre class="code">
Bitmap tube = BitmapFactory.decodeResource(GameView.getResources(), R.mipmap.tube);
Bitmap resize = Bitmap.createScaledBitmap(tube, w, h, false);
GameView.canvas.drawBitmap(resize, x-scroll, y, GameView.paint);
</pre>
The method createScaledBitmap() takes a source bitmap and two integers (width and height) and returns a bitmap with the desired scaling.
	</li><br><br>
</ul>
		
		
</td></tr></table>
</body></html>
